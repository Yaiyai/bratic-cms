(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{217:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n.n(a),r=n(28),i=n.n(r),s=n(8),o=(0,n(2).createContext)(),u=n(3),l={login:"[auth] login",signup:"[auth] signup",logout:"[auth] logout",hasToken:"[auth] hastoken",getCompany:"[company] getCompany",addCompany:"[company] addCompany",companyUpdate:"[company] companyUpdate",companyDelete:"[company] companyDelete",getPosts:"[post] getPosts",getThisPost:"[post] getThisPost",addPost:"[post] addPost",postUpdate:"[post] postUpdate",postCategoriesUpdate:"[post] postCategoriesUpdate",addSection:"[Section] addSection",getSections:"[Section] getSections",sectionUpdate:"[Section] sectionUpdate",deleteSection:"[Section] deleteSection",updateThis:"[Section] updateThis"},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.login:case l.signup:case l.hasToken:return Object(u.a)({},t.payload);case l.logout:return{logged:!1};default:return e}},j=(n(95),n(96),n(97),n(98),n(99),n(14)),b=n(17),p=n(24),m="https://bratic-app.herokuapp.com/api",O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(m,"/").concat(e);return"GET"===n?fetch(a):fetch(a,{method:n,headers:{"Content-type":"application/json"},body:JSON.stringify(t)})},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",a="".concat(m,"/").concat(e),c=localStorage.getItem("bratic-token")||"";return"GET"===n?fetch(a,{method:n,headers:{"x-token":c}}):fetch(a,{method:n,headers:{"Content-type":"application/json","x-token":c},body:JSON.stringify(t)})},f=(0,n(2).createContext)(),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.getCompany:case l.addCompnany:case l.companyUpdate:case l.deleteProperty:return Object(u.a)({},t.payload);case l.maquinasCategoriesUpdate:return Object(u.a)(Object(u.a)({},e),{},{maquinasCategories:t.payload});case l.companyDelete:return{};default:return e}},v=(0,n(2).createContext)(),g=n(12),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.getSections:return t.payload;case l.addSection:return[].concat(Object(g.a)(e),[t.payload]);case l.deleteSection:return t.payload;case l.updateThis:return Object(u.a)({},t.payload);case l.sectionUpdate:return t.payload;default:return e}},C=n(29),k=n(4),N=n.n(k),w=n(5),S=n(1),E=function(e){var t=e.nameValue,n=e.deleteField,c=e.inputType,r=e.editLabel,i=e.editAction,o=e.editValue,u=e.submitEdit,l=e.imageEdit,d=void 0!==l&&l,j=Object(a.useState)(!1),b=Object(s.a)(j,2),m=b[0],O=b[1],h=function(){return O(!1)},f=function(){return O(!0)};return Object(S.jsxs)(S.Fragment,{children:[o?Object(S.jsxs)("div",{className:"edit-group",children:[d?Object(S.jsxs)("div",{children:[Object(S.jsxs)("p",{children:[r,": "]}),Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:o,alt:t})})]}):Object(S.jsxs)("p",{children:[r,": ",Object(S.jsx)("strong",{children:o})]}),Object(S.jsxs)("div",{children:[Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return n(t)},children:"Borrar"}),Object(S.jsx)("button",{className:"my-btn mini",onClick:f,children:"Editar"})]})]}):Object(S.jsxs)("div",{className:"edit-group",children:[Object(S.jsxs)("p",{children:[r,": ",Object(S.jsx)("small",{children:"Sin datos"})]}),Object(S.jsx)("button",{className:"my-btn mini",onClick:f,children:"A\xf1adir"})]}),Object(S.jsxs)(p.a,{className:"edit-modal my-modals",show:m,onHide:h,children:[Object(S.jsx)(p.a.Header,{children:Object(S.jsx)(p.a.Title,{children:o})}),Object(S.jsx)(p.a.Body,{children:Object(S.jsxs)("form",{className:"edit-form",onSubmit:u,children:[Object(S.jsx)("input",{name:t,type:c,onChange:i,placeholder:o}),Object(S.jsx)("button",{className:"my-btn mini",type:"submit",onClick:h,children:"Guardar"})]})}),Object(S.jsx)(p.a.Footer,{children:Object(S.jsx)("button",{className:"my-btn mini danger",onClick:h,children:"cerrar"})})]})]})},T=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api.cloudinary.com/v1_1/bratic-app/upload",(n=new FormData).append("upload_preset","bratic-app"),n.append("file",t),n.append("folder","web"),e.next=7,fetch("https://api.cloudinary.com/v1_1/bratic-app/upload",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){return a=e.secure_url})).catch((function(e){return console.log(e)}));case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(s.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(!1),o=Object(s.a)(i,2),l=o[0],d=o[1],j=function(){r(e)},b=function(e){var t=e.target;r(Object(u.a)(Object(u.a)({},c),{},Object(C.a)({},t.name,t.value)))},p=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,d(!0),a=n.files[0],e.next=5,T(a);case 5:return i=e.sent,e.next=8,r(Object(u.a)(Object(u.a)({},c),{},Object(C.a)({},n.name,i)));case 8:d(!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{values:c,setValues:r,handleInputChange:b,handleFileChange:p,resetForm:j,loading:l}},I=n(11),B=n.n(I),F=function(){var e=Object(w.a)(N.a.mark((function e(){var t,n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("companies/","GET");case 2:return t=e.sent,e.next=5,t.json();case 5:if(!(n=e.sent).ok){e.next=9;break}return a=n.company,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("companies/",t,"POST");case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent).ok){e.next=9;break}return c=a.company,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("companies/".concat(t),n,"PUT");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=12;break}return r=c.company,B.a.fire("\xa1Chachi!","Los cambios han sido guardados","success"),e.abrupt("return",r);case 12:i=c.error,B.a.fire("Error",i,"error");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("companies/".concat(t),{},"DELETE");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.title,n=e.instructions,c=e.image,r=Object(a.useContext)(o).user;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("p",{className:"dashboard-user",children:["Conectad@ como ",Object(S.jsx)("span",{children:r.name})]}),Object(S.jsxs)("div",{className:"section-title",children:[Object(S.jsx)("h1",{children:t}),Object(S.jsx)("p",{children:n}),Object(S.jsx)("img",{src:c,alt:""})]})]})},V=n(20),Y=function(){var e,t=Object(a.useState)(),n=Object(s.a)(t,2),c=n[0],r=n[1],i=D(),o=i.values,l=i.setValues,d=i.handleInputChange,j=i.handleFileChange,b=Object(a.useCallback)(Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:t=e.sent,l(t[0]);case 4:case"end":return e.stop()}}),e)}))),[l]);Object(a.useEffect)((function(){b()}),[b]);var p=function(){var e=Object(w.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(null===o||void 0===o?void 0:o._id);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){document.getElementById("to-reset-category").value=""},O=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(C.a)({},t,""))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e){e.preventDefault()},f=function(){var e=Object(w.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(o._id,o);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695927/web/company_ppk0jk.svg",title:"Datos de empresa",instructions:"Aqu\xed puedes editar los datos de tu empresa :)"}),Object(S.jsx)("button",{className:"my-btn mini",onClick:f,children:"Guardar Cambios"}),Object(S.jsx)("button",{className:"my-btn danger mini",onClick:function(){B.a.fire({title:"\xbfSeguro?",text:"Si borras esto, no habr\xe1 datos de empresa",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\xa1Borrar Empresa!",cancelButtonText:"\xa1Uy, no!"}).then((function(e){e.isConfirmed&&(p(),B.a.fire("\xa1Empresa borrada!","Esta empresa se march\xf3 para no volver","success"))}))},children:"Borrar esta empresa"}),Object(S.jsxs)("div",{className:"editing",children:[Object(S.jsx)(E,{deleteField:O,nameValue:"name",inputType:"text",editLabel:"Nombre de empresa",editAction:d,editValue:null===o||void 0===o?void 0:o.name,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"address",inputType:"text",editLabel:"Direcci\xf3n",editAction:d,editValue:null===o||void 0===o?void 0:o.address,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"phone",inputType:"text",editLabel:"Tel\xe9fono principal",editAction:d,editValue:null===o||void 0===o?void 0:o.phone,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"mainEmail",inputType:"email",editLabel:"Email principal",editAction:d,editValue:null===o||void 0===o?void 0:o.mainEmail,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"mainLogo",imageEdit:!0,inputType:"file",editLabel:"Logo Principal",editAction:j,editValue:null===o||void 0===o?void 0:o.mainLogo,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"secondaryLogo",imageEdit:!0,inputType:"file",editLabel:"Logo BN",editAction:j,editValue:null===o||void 0===o?void 0:o.secondaryLogo,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"twitter",inputType:"text",editLabel:"Twitter Url",editAction:d,editValue:null===o||void 0===o?void 0:o.twitter,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"facebook",inputType:"text",editLabel:"Facebook url",editAction:d,editValue:null===o||void 0===o?void 0:o.facebook,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"instagram",inputType:"text",editLabel:"Instagram Url",editAction:d,editValue:null===o||void 0===o?void 0:o.instagram,submitEdit:h}),Object(S.jsx)(E,{deleteField:O,nameValue:"linkedin",inputType:"text",editLabel:"Linkedin Url",editAction:d,editValue:null===o||void 0===o?void 0:o.linkedin,submitEdit:h}),Object(S.jsxs)("div",{className:"edit-group categories",children:[Object(S.jsx)("p",{className:"maq-cat-title",children:"Categor\xedas de posts:"}),Object(S.jsx)("div",{className:"features",children:null===o||void 0===o||null===(e=o.categories)||void 0===e?void 0:e.map((function(e,t){return Object(S.jsxs)("div",{className:"each-feat",children:[e,Object(S.jsx)(V.b,{onClick:function(){return function(e){var t=Object(g.a)(null===o||void 0===o?void 0:o.categories);t.splice(e,1),l((function(e){return Object(u.a)(Object(u.a)({},e),{},{categories:[t]})}))}(t)}})]},e+t)}))}),Object(S.jsxs)("div",{className:"button-input-group",children:[Object(S.jsx)("input",{type:"text",id:"to-reset-category",onChange:function(e){r(e.target.value)},placeholder:"A\xf1adir Categor\xeda",name:"features"}),Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(e){e.preventDefault(),(null===o||void 0===o?void 0:o.categories.includes(c))||(l((function(e){return Object(u.a)(Object(u.a)({},e),{},{categories:[].concat(Object(g.a)(null===o||void 0===o?void 0:o.categories),[c])})})),m()),m()},children:"A\xf1adir"})]})]})]})]})},R=function(){var e=D({}),t=e.values,n=e.handleInputChange,a=e.handleFileChange,c=function(){var e=Object(w.a)(N.a.mark((function e(n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695927/web/company_ppk0jk.svg",title:"A\xf1adir Empresa",instructions:"A\xf1ade los datos de tu empresa :)"}),Object(S.jsxs)("form",{className:"add-form",onSubmit:c,children:[Object(S.jsx)("input",{type:"text",name:"name",placeholder:"Nombre de la empresa",onChange:n}),Object(S.jsx)("input",{type:"email",name:"mainEmail",placeholder:"Correo Principal",onChange:n}),Object(S.jsx)("input",{type:"text",name:"phone",placeholder:"Tel\xe9fono principal",onChange:n}),Object(S.jsx)("input",{type:"text",name:"address",placeholder:"Direcci\xf3n",onChange:n}),Object(S.jsx)("input",{type:"text",name:"linkedin",placeholder:"URL Linkedin",onChange:n}),Object(S.jsx)("input",{type:"text",name:"facebook",placeholder:"URL Facebook",onChange:n}),Object(S.jsx)("input",{type:"text",name:"instagram",placeholder:"URL Instagram",onChange:n}),Object(S.jsx)("input",{type:"text",name:"twitter",placeholder:"URL Twitter",onChange:n}),Object(S.jsxs)("div",{className:"input-images",children:[Object(S.jsxs)("div",{children:[Object(S.jsx)("label",{htmlFor:"mainLogo",children:"Logo principal"}),Object(S.jsx)("input",{type:"file",className:"file-input",name:"mainLogo",id:"mainLogo",placeholder:"Logo Principal",onChange:a})]}),Object(S.jsxs)("div",{children:[Object(S.jsx)("label",{htmlFor:"secondaryLogo",children:"Logo en BN"}),Object(S.jsx)("input",{type:"file",className:"file-input",name:"secondaryLogo",id:"secondaryLogo",placeholder:"Logo Secundario",onChange:a})]})]}),Object(S.jsx)("button",{className:"my-btn mini",type:"submit",children:"Crear empresa"})]})]})},q=function(){var e=Object(a.useRef)(!0),t=Object(a.useContext)(f).company;return Object(a.useEffect)((function(){return function(){e.current=!1}}),[]),Object(S.jsx)(S.Fragment,{children:t._id?Object(S.jsx)(Y,{}):Object(S.jsx)(R,{})})},G=function(){return Object(S.jsx)("section",{id:"dashboard-screen",children:Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621696920/web/dashboard2_zwjqif.svg",title:"Dashboard",instructions:"\xc9ste es el dashboard de gesti\xf3n de contenido de tu web :)"})})},U=n(32),M=function(e){var t=e.handleShow,n=Object(a.useContext)(o),c=n.dispatch,r=n.user,i=Object(a.useState)(),u=Object(s.a)(i,2),d=u[0],b=u[1],p=function(){var e=Object(w.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({type:l.logout});case 2:localStorage.removeItem("bratic-token"),localStorage.removeItem("bratic-user");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("nav",{className:"dash-nav ",children:[Object(S.jsx)(j.b,{to:"/bratic",onClick:function(){return b("")},children:Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:"https://res.cloudinary.com/bratic-app/image/upload/v1609866461/logoBN_ujpbti.svg",alt:""})})}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:Object(S.jsxs)(j.b,{to:"/bratic/empresa",onClick:function(){return b("empresa")},children:[Object(S.jsx)(U.a,{className:"empresa"===d?"active":null}),Object(S.jsx)("span",{children:"Empresa"})]})}),Object(S.jsx)("li",{children:Object(S.jsxs)(j.b,{to:"/bratic/blog",onClick:function(){return b("blog")},children:[Object(S.jsx)(U.c,{className:"blog"===d?"active":null}),Object(S.jsx)("span",{children:"Blog"})]})}),Object(S.jsx)("li",{children:Object(S.jsxs)(j.b,{to:"/bratic/seccion",onClick:function(){return b("secciones")},children:[Object(S.jsx)(U.d,{className:"secciones"===d?"active":null}),Object(S.jsx)("span",{children:"Secciones"})]})})]}),Object(S.jsxs)("div",{className:"btn-group",children:["admin@yai.com"===r.email&&Object(S.jsx)(U.e,{onClick:t}),Object(S.jsx)(U.b,{onClick:p})]})]})})},H=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("posts/".concat(t),"GET");case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent).ok){e.next=9;break}return c=a.posts,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("posts/post/id/".concat(t),"GET");case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent).ok){e.next=9;break}return c=a.post,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("posts/",t,"POST");case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent).ok){e.next=9;break}return c=a.post,e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("posts/".concat(t),n,"PUT");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=12;break}return r=c.post,B.a.fire("\xa1Chachi!","Los cambios han sido guardados","success"),e.abrupt("return",r);case 12:i=c.error,B.a.fire("Error",i,"error");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("posts/".concat(t),{},"DELETE");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=n(19),W=n.n(K);n(40);W.a.locale("es");var X=function(e){var t=e.askIfDelete,n=e.post;return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("article",{className:"each-post-prev",children:[Object(S.jsxs)("div",{className:"info",children:[Object(S.jsx)("h5",{children:n.title}),(null===n||void 0===n?void 0:n.postDate)?Object(S.jsxs)("p",{children:["Fecha de publicaci\xf3n: ",Object(S.jsx)("strong",{children:W()(null===n||void 0===n?void 0:n.postDate).format("DD/MM/YYYY")})]}):Object(S.jsxs)("p",{children:["Fecha de publicaci\xf3n: ",Object(S.jsx)("strong",{children:W()(null===n||void 0===n?void 0:n.createdAt).format("DD/MM/YYYY")})]}),Object(S.jsxs)("p",{children:["Fecha de la \xfaltima edici\xf3n: ",Object(S.jsx)("strong",{children:W()(null===n||void 0===n?void 0:n.updatedAt).format("DD/MM/YYYY")})]}),Object(S.jsxs)("p",{className:"status",children:["Estado de la publicaci\xf3n: ",Object(S.jsx)("strong",{children:n.status})]})]}),Object(S.jsxs)("div",{className:"btn-group",children:[Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(){return t(n._id)},children:"Borrar Entrada"}),Object(S.jsx)(j.b,{className:"my-btn mini secondary",to:"/bratic/blog/editar-entrada/".concat(n._id),children:"Editar Entrada"}),Object(S.jsx)(j.b,{className:"my-btn mini ",to:"/bratic/blog/".concat(n._id),children:"Ver Muestra"})]})]})})},Z=function(){var e=Object(b.useHistory)(),t=Object(a.useRef)(!0),n=Object(a.useState)(),c=Object(s.a)(n,2),r=c[0],i=c[1],u=Object(a.useContext)(o).user,l=function(){var e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(u.id);case 2:t=e.sent,i(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){return function(){t.current=!1}}),[]),Object(a.useEffect)((function(){return t.current&&l(),function(){t.current=!1}}));var d=function(){var t=Object(w.a)(N.a.mark((function t(){var n;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J({title:"Entrada Sin T\xedtulo",postDate:new Date,author:u.id});case 2:n=t.sent,e.push("/bratic/blog/nueva-entrada/".concat(n._id));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t);case 2:return e.next=4,l();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){B.a.fire({title:"\xbfSeguro?",text:"Si borras esto, la entrada desaparece",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\xa1Borrar Entrada!",cancelButtonText:"\xa1Uy, no!"}).then((function(t){t.isConfirmed&&j(e)}))};return Object(S.jsxs)("div",{id:"posts-screen",children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695842/web/blog_vadvsn.svg",title:"Entradas del Blog",instructions:"Est\xe1s viendo las entradas del blog que ".concat(u.name," (t\xfa, se\xf1or@) ha creado")}),Object(S.jsx)("button",{className:"my-btn primary mini",onClick:d,children:"A\xf1adir entrada del blog"}),(null===r||void 0===r?void 0:r.length)>0?Object(S.jsx)("section",{className:"all-posts",children:null===r||void 0===r?void 0:r.map((function(e){return Object(S.jsx)(X,{askIfDelete:p,post:e},e._id)}))}):Object(S.jsx)("article",{className:"empty-posts",children:"No tienes entradas del blog"})]})},ee=n(89),te=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("texts/".concat(n),t,"POST");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=11;break}return r=c.text,e.abrupt("return",r);case 11:i=c.msg,B.a.fire("\xa1Oh-oh!",i,"error");case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ne=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("texts/".concat(t),{},"DELETE");case 2:return n=e.sent,e.next=5,n.json();case 5:(a=e.sent).ok?B.a.fire("\xa1Bien!","Texto borrado","success"):(c=a.msg,B.a.fire("\xa1Oh-oh!",c,"error"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("images/".concat(n),t,"POST");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=11;break}return r=c.image,e.abrupt("return",r);case 11:i=c.msg,B.a.fire("\xa1Oh-oh!",i,"error");case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ce=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("images/".concat(t),{},"DELETE");case 2:return n=e.sent,e.next=5,n.json();case 5:(a=e.sent).ok?B.a.fire("\xa1Bien!","Imagen Borrada","success"):(c=a.msg,B.a.fire("\xa1Oh-oh!",c,"error"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(e){var t=e.selectedPost,n=e.saveTitles,a=e.handleInputChange;return Object(S.jsx)("article",{className:"title-area",children:Object(S.jsxs)("form",{className:"form-title",onSubmit:n,children:[Object(S.jsx)("label",{htmlFor:"title",children:"T\xedtulo de la Entrada"}),Object(S.jsx)("input",{id:"title",type:"text",name:"title",onChange:a,placeholder:t.title}),Object(S.jsx)("label",{htmlFor:"subtitle",children:"Subt\xedtulo de la Entrada"}),Object(S.jsx)("input",{id:"subtitle",type:"text",name:"subtitle",placeholder:t.subtitle,onChange:a}),Object(S.jsx)("button",{className:"my-btn mini third",type:"submit",children:" Guardar t\xedtulos "})]})})},ie=function(e){var t=e.loading;return Object(S.jsx)("section",{id:"loading",className:t?"show":"hide",children:Object(S.jsxs)("div",{className:"lds-ripple",children:[Object(S.jsx)("div",{}),Object(S.jsx)("div",{})]})})},se=function(e){var t=e.saveElement,n=e.postID,a=D(),c=a.values,r=a.handleFileChange,i=a.loading,s=function(){var e=Object(w.a)(N.a.mark((function e(){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae({image:c.image},n);case 2:a=e.sent,t("image",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsxs)("section",{className:"add-image",children:[Object(S.jsx)("div",{className:"file-group",children:Object(S.jsx)("input",{type:"file",className:"file-input",name:"image",id:"image",onChange:r})}),i?Object(S.jsx)(ie,{loading:!0}):(null===c||void 0===c?void 0:c.image)&&Object(S.jsxs)("div",{className:"muestra",children:[Object(S.jsx)("figure",{children:Object(S.jsx)("img",{className:"unique-image",src:c.image,alt:""})}),Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(){return s()},children:" A\xf1adir Imagen a la Entrada"})]})]})},oe=n(51),ue=n.n(oe),le=(n(84),function e(t){var n=t.setQuill,c=Object(a.useState)(""),r=Object(s.a)(c,2),i=r[0],o=r[1],u=Object(a.useRef)(null);return Object(a.useEffect)((function(){n(i)})),Object(S.jsx)("div",{children:Object(S.jsx)("div",{className:"text-editor",children:Object(S.jsx)(ue.a,{ref:u,modules:{toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{script:"sub"},{script:"super"}],["link"]]},clipboard:{matchVisual:!1}},formats:e.formats,theme:"snow",value:i,onChange:o})})})});le.formats=["header","bold","italic","underline","strike","blockquote","list","bullet","indent","link","align","color","script","background"];var de=le,je=function(e){var t=e.saveElement,n=e.postID,c=Object(a.useRef)(!0),r=Object(a.useState)(),i=Object(s.a)(r,2),o=i[0],u=i[1],l=D(),d=l.values,j=l.setValues,b=function(){var e=Object(w.a)(N.a.mark((function e(){var a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(d,n);case 2:a=e.sent,t("text",a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){return function(){c.current=!1}}),[]),Object(a.useEffect)((function(){c.current&&j({text:o,parsedText:{__html:o}})}),[o,j]),Object(S.jsxs)("section",{className:"add-text",children:[Object(S.jsx)(de,{setQuill:u}),Object(S.jsx)("button",{className:"my-btn mini",onClick:function(){return b()},children:"A\xf1adir Texto a la entrada"})]})},be=function(e){var t=e.auxContent,n=e.setAuxContent,a=e.select,c=e.postId,r=e.saveElement;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{children:"Tienes que a\xf1adir obligatoriamente, por lo menos, una imagen"}),Object(S.jsxs)("select",{ref:a,onChange:function(e){switch(e.target.value){case"text":n("text");break;case"image":n("image");break;default:n("default")}},name:"content",placeholder:"A\xf1adir...",children:[Object(S.jsx)("option",{value:"default",defaultValue:!0,children:" A\xf1adir Elemento a la entrada... "}),Object(S.jsx)("option",{value:"text",children:"Texto"}),Object(S.jsx)("option",{value:"image",children:"Imagen"})]}),Object(S.jsxs)("article",{className:"add-post",children:["text"===t&&Object(S.jsx)(je,{saveElement:r,postID:c}),"image"===t&&Object(S.jsx)(se,{saveElement:r,postID:c})]})]})},pe=function(e){var t=e.postState,n=e.savePostState,c=Object(a.useContext)(o).user;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{className:"post-state-instructions",children:'Cambia el estado de la publicaci\xf3n para que se vea en la web. Por defecto, se crean en modo "borrador"'}),Object(S.jsxs)("select",{onChange:function(e){var t=e.target;n(t.value)},children:[Object(S.jsxs)("option",{value:"default",defaultValue:!0,children:[" ",t||"Cambiar Estado de la publicaci\xf3n..."," "]}),"borrador"!==t&&Object(S.jsx)("option",{value:"borrador",children:"Borrador"}),"publicado"!==t&&Object(S.jsx)("option",{value:"publicado",children:"Publicada"}),"privada"!==t&&Object(S.jsx)("option",{value:"privada",children:"Privada"}),"admin@yai.com"===c.email&&Object(S.jsx)("option",{value:"borrada",children:"Borrada"})]})]})},me=function(e){var t=e.setSelectedPost;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{children:"Has a\xf1adido m\xe1s de una imagen, \xbfC\xf3mo quieres que aparezcan en la entrada?"}),Object(S.jsxs)("select",{name:"images-view",onChange:function(e){switch(e.target.value){case"galeria":t((function(e){return Object(u.a)(Object(u.a)({},e),{},{isGallery:!0,isSlider:!1})}));break;case"slider":t((function(e){return Object(u.a)(Object(u.a)({},e),{},{isGallery:!1,isSlider:!0})}));break;default:t((function(e){return Object(u.a)(Object(u.a)({},e),{},{isGallery:!1,isSlider:!1})}))}},placeholder:"Galer\xeda/Slider",children:[Object(S.jsx)("option",{value:"default",defaultValue:!0,children:" Galer\xeda/Slider "}),Object(S.jsx)("option",{value:"slider",children:"Slider"}),Object(S.jsx)("option",{value:"galeria",children:"Galer\xeda"})]})]})},Oe=function(e){for(var t="!@#$^&%*()+=[]/{}|:<>?\xbf\xa1\"'\u201c\u201d,.",n=0;n<t.length;n++)e=e.replace(new RegExp("\\"+t[n],"gi"),"");return e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/ /gi,"-")).replace(/\xe1/gi,"a")).replace(/\xe9/gi,"e")).replace(/\xed/gi,"i")).replace(/\xf3/gi,"o")).replace(/\xfa/gi,"u")).replace(/\xf1/gi,"n")},he=function(e){e.selectedPost;var t=e.saveDate,n=e.handleInputChange;return Object(S.jsx)("article",{className:"title-area",children:Object(S.jsxs)("form",{className:"form-title",onSubmit:t,children:[Object(S.jsx)("label",{htmlFor:"postDate",children:"\xbfQuieres modificar la fecha de publicaci\xf3n? Por defecto saldr\xe1 la fecha de creaci\xf3n de la entrada."}),Object(S.jsx)("input",{id:"postDate",type:"date",name:"postDate",onChange:n}),Object(S.jsx)("button",{className:"my-btn mini third",type:"submit",children:" Guardar nueva fecha "})]})})},fe=function(e){var t,n,c=e.saveCategory,r=(e.deleteCategory,Object(a.useContext)(f).company);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("label",{children:"Categor\xeda/s de la Publicaci\xf3n"}),Object(S.jsxs)("select",{name:"category",onChange:function(e){var t=e.target.value;c(t)},children:[Object(S.jsx)("option",{value:"default",defaultValue:!0,children:" A\xf1adir Categor\xeda... "}),(null===r||void 0===r||null===(t=r.categories)||void 0===t?void 0:t.length)&&(null===r||void 0===r||null===(n=r.categories)||void 0===n?void 0:n.map((function(e){return Object(S.jsx)("option",{value:e,children:e},e)})))]})]})};W.a.locale("es");var xe=function(){var e=Object(b.useHistory)(),t=Object(ee.useParams)(),n=Object(a.useRef)(),c=D(),r=c.values,i=c.handleInputChange,o=Object(a.useState)(),l=Object(s.a)(o,2),d=l[0],j=l[1],p=Object(a.useState)("default"),m=Object(s.a)(p,2),O=m[0],h=m[1],f=Object(a.useState)({title:"Sin t\xedtulo",slug:"",postDate:"",slugArray:[],subtitle:"",content:{image:[],text:[]}}),x=Object(s.a)(f,2),v=x[0],y=x[1];Object(a.useEffect)((function(){j(t.postID),C(t.postID)}),[t.postID]),Object(a.useEffect)((function(){var e=Oe(v.title);y((function(t){return Object(u.a)(Object(u.a)({},t),{},{slug:e,slugArray:"Entrada Sin T\xedtulo"===t.title?Object(g.a)(t.slugArray):[].concat(Object(g.a)(t.slugArray),[e])})}))}),[v.title]);var C=function(){var e=Object(w.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:n=e.sent,y(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=Object(g.a)(v.categories).filter((function(t){return t!==e}));y((function(e){return Object(u.a)(Object(u.a)({},e),{},{categories:t})}))},E=function(){n.current.selectedIndex=0,h("default")},T=function(){B.a.fire({title:"\xbfSeguro?",text:"No has guardado, si sales sin guardar, se perder\xe1n los cambios",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\xa1Si, salir!",cancelButtonText:"\xa1Uy, no!"}).then((function(t){t.isConfirmed&&e.goBack()}))},I=function(){var t=Object(w.a)(N.a.mark((function t(n){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,$(n);case 2:e.goBack();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),F=function(){var t=Object(w.a)(N.a.mark((function t(n,a){return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(n,a);case 2:e.goBack();case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),A=function(){var e=Object(w.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="text"===e.t0?3:"image"===e.t0?7:11;break;case 3:return e.next=5,ne(n);case 5:return y((function(e){return Object(u.a)(Object(u.a)({},e),{},{content:Object(u.a)(Object(u.a)({},e.content),{},{text:e.content.text.filter((function(e){return e._id!==n}))})})})),e.abrupt("break",12);case 7:return e.next=9,ce(n);case 9:return y((function(e){return Object(u.a)(Object(u.a)({},e),{},{content:Object(u.a)(Object(u.a)({},e.content),{},{image:e.content.image.filter((function(e){return e._id!==n}))})})})),e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(S.jsxs)("section",{id:"add-posts-screen",children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695842/web/blog-single_zvpet3.svg",title:"Nueva entrada",instructions:"Est\xe1s a\xf1adiendo una entrada nueva al blog :)"}),Object(S.jsxs)("article",{className:"post-btn-group",children:[Object(S.jsx)("button",{className:"my-btn mini",onClick:function(){return F(d,v)},children:"Guardar Entrada"}),Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(){return T()},children:"Salir"}),Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return I(d)},children:"Borrar Entrada"})]}),Object(S.jsxs)("section",{className:"edit-post",children:[Object(S.jsxs)("div",{className:"edit-area",children:[Object(S.jsx)(re,{selectedPost:y,handleInputChange:i,saveTitles:function(e){e.preventDefault(),y(Object(u.a)(Object(u.a)({},v),{},{title:r.title,subtitle:r.subtitle}))}}),Object(S.jsx)(he,{selectedPost:y,handleInputChange:i,saveDate:function(e){e.preventDefault(),y(Object(u.a)(Object(u.a)({},v),{},{postDate:r.postDate}))}}),Object(S.jsx)(pe,{savePostState:function(e){y(Object(u.a)(Object(u.a)({},v),{},{status:e}))},postState:v.status}),Object(S.jsx)(fe,{saveCategory:function(e){v.categories.includes(e)||y((function(t){return Object(u.a)(Object(u.a)({},t),{},{categories:[].concat(Object(g.a)(t.categories),[e])})}))},deleteCategory:k}),Object(S.jsx)(be,{auxContent:O,setAuxContent:h,select:n,postId:d,saveElement:function(e,t){switch(e){case"text":if(v.content.text.length>0){var n=[].concat(Object(g.a)(v.content.text),[t]);y(Object(u.a)(Object(u.a)({},v),{},{content:Object(u.a)(Object(u.a)({},v.content),{},{text:n})})),E()}else{var a=[t];y(Object(u.a)(Object(u.a)({},v),{},{content:Object(u.a)(Object(u.a)({},v.content),{},{text:a})})),E()}break;case"image":if(v.content.image.length>0){var c=[].concat(Object(g.a)(v.content.image),[t]);y(Object(u.a)(Object(u.a)({},v),{},{content:Object(u.a)(Object(u.a)({},v.content),{},{image:c})})),E()}else{var r=[t];y(Object(u.a)(Object(u.a)({},v),{},{content:Object(u.a)(Object(u.a)({},v.content),{},{image:r})})),E()}}}}),v.content.image.length>1&&Object(S.jsx)(me,{setSelectedPost:y})]}),Object(S.jsxs)("div",{className:"view-area",children:[Object(S.jsx)("div",{className:"titles-btn",children:Object(S.jsxs)("div",{children:[v.title&&Object(S.jsx)("h1",{children:v.title}),v.subtitle&&Object(S.jsx)("h2",{children:v.subtitle}),v.postDate?Object(S.jsxs)("p",{children:["Publicada el: ",W()(v.postDate).format("DD/MM/YYYY")]}):Object(S.jsxs)("p",{children:["Publicada el: ",W()(v.createdAt).format("DD/MM/YYYY")]}),v.categories.length>0&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("p",{children:"Categor\xedas de la publicaci\xf3n"}),Object(S.jsx)("div",{className:"features",children:v.categories.map((function(e){return Object(S.jsxs)("div",{className:"each-feat",children:[e," ",Object(S.jsx)(V.b,{onClick:function(){return k(e)}})," "]},e)}))})]})]})}),v.content.text.length>0&&v.content.text.map((function(e){return Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{dangerouslySetInnerHTML:e.parsedText}),Object(S.jsx)("button",{className:"my-btn mini",onClick:function(){return A("text",e._id)},children:"Borrar"})]},e._id)})),v.content.image.length>0&&v.content.image.map((function(e){return Object(S.jsxs)("div",{children:[Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:e.image,alt:""})}),Object(S.jsx)("button",{className:"my-btn mini",onClick:function(){return A("image",e._id)},children:"Borrar"})]},e._id)}))]})]})]})},ve=n(224),ge=n(221),ye=n(222),Ce=n(225),ke=n(223),Ne=n(90);ve.a.use([ge.a,ye.a]),W.a.locale("es");var we=function(){var e,t,n,c,r,i,o,u=Object(a.useRef)(!0),l=Object(b.useParams)().postID,d=Object(b.useHistory)(),p=Object(a.useState)(),m=Object(s.a)(p,2),O=m[0],h=m[1],f=Object(a.useState)([]),x=Object(s.a)(f,2),v=x[0],y=x[1],C=function(){var e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(l);case 2:t=e.sent,h(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){return u.current&&C(),function(){u.current=!1}})),Object(a.useEffect)((function(){var e;(null===O||void 0===O?void 0:O.isGallery)&&(null===O||void 0===O||null===(e=O.content)||void 0===e||e.image.forEach((function(e){y((function(t){return[].concat(Object(g.a)(t),[{src:e.image,thumbnail:E(e.image),w:1200,h:900}])}))})))}),[O]);var k=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t);case 2:d.push("/bratic/blog");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e){var t=e.split("upload/");return"".concat(t[0]).concat("upload/w_200/").concat(t[1])};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621696886/web/dashboard_jrqf3g.svg",title:"Muestra de la entrada",instructions:"As\xed es como se ver\xe1 la entrada en la web :)"}),Object(S.jsxs)("section",{id:"post-preview",children:[Object(S.jsx)("h1",{children:null===O||void 0===O?void 0:O.title}),Object(S.jsxs)("div",{className:"date-cat",children:[(null===O||void 0===O?void 0:O.categories.length)>0&&Object(S.jsx)("div",{className:"categories",children:null===O||void 0===O||null===(e=O.categories)||void 0===e?void 0:e.map((function(e){return Object(S.jsx)("small",{children:e},e)}))}),(null===O||void 0===O?void 0:O.categories.length)>0&&Object(S.jsx)("span",{className:"separator",children:" \xb7 "}),(null===O||void 0===O?void 0:O.postDate)?Object(S.jsx)("small",{children:W()(null===O||void 0===O?void 0:O.postDate).format("DD/MM/YYYY")}):Object(S.jsx)("small",{children:W()(null===O||void 0===O?void 0:O.createdAt).format("DD/MM/YYYY")})]}),(null===O||void 0===O||null===(t=O.content)||void 0===t?void 0:t.image.length)>0&&Object(S.jsx)("figure",{className:"main-image",children:Object(S.jsx)("img",{src:null===O||void 0===O?void 0:O.content.image[0].image,alt:""},null===O||void 0===O?void 0:O.content.image[0]._id)}),Object(S.jsxs)("div",{className:"app-container",children:[(null===O||void 0===O?void 0:O.subtitle)&&Object(S.jsx)("h2",{children:null===O||void 0===O?void 0:O.subtitle}),(null===O||void 0===O||null===(n=O.content)||void 0===n||null===(c=n.text)||void 0===c?void 0:c.length)>0&&(null===O||void 0===O||null===(r=O.content)||void 0===r||null===(i=r.text)||void 0===i?void 0:i.map((function(e,t){return Object(S.jsx)("div",{className:"post-text",dangerouslySetInnerHTML:e.parsedText},e._id)}))),(null===O||void 0===O?void 0:O.isSlider)&&Object(S.jsx)(Ce.a,{spaceBetween:16,autoplay:{delay:2500},slidesPerView:3,children:null===O||void 0===O||null===(o=O.content)||void 0===o?void 0:o.image.map((function(e,t){return Object(S.jsx)(ke.a,{children:Object(S.jsx)("img",{src:e.image,alt:""})},t)}))}),(null===O||void 0===O?void 0:O.isGallery)&&(null===v||void 0===v?void 0:v.length)>0&&Object(S.jsx)(Ne.PhotoSwipeGallery,{items:v,thumbnailContent:function(e){return Object(S.jsx)("img",{src:e.thumbnail,alt:""})}})]}),Object(S.jsxs)("div",{className:"btn-group",children:[Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(){return e=null===O||void 0===O?void 0:O._id,void B.a.fire({title:"\xbfSeguro?",text:"Si borras esto, la entrada desaparece",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\xa1Borrar Entrada!",cancelButtonText:"\xa1Uy, no!"}).then((function(t){t.isConfirmed&&(k(e),B.a.fire("\xa1Entrada borrada!","Esta entrada se march\xf3 para no volver","success"))}));var e},children:"Borrar"}),Object(S.jsx)(j.b,{className:"my-btn mini secondary",to:"/bratic/blog/editar-entrada/".concat(null===O||void 0===O?void 0:O._id),children:"Editar"}),Object(S.jsx)(j.b,{className:"my-btn mini thirsd",to:"/bratic/blog/",children:"Volver al blog"})]})]})]})};W.a.locale("es");var Se=function(){var e,t,n=Object(b.useHistory)(),c=Object(b.useParams)(),r=Object(a.useRef)(),i=D(),o=i.values,l=i.handleInputChange,d=Object(a.useState)(),j=Object(s.a)(d,2),p=j[0],m=j[1],O=Object(a.useState)("default"),h=Object(s.a)(O,2),f=h[0],x=h[1],v=Object(a.useState)({title:"Sin t\xedtulo",subtitle:"",slugArray:[],content:{slider:[],image:[],text:[],video:[],gallery:[]}}),y=Object(s.a)(v,2),C=y[0],k=y[1];Object(a.useEffect)((function(){m(c.postID),E(c.postID)}),[c.postID]),Object(a.useEffect)((function(){var e=Oe(C.title);Object(g.a)(C.slugArray).includes(e)?k((function(t){return Object(u.a)(Object(u.a)({},t),{},{slug:e})})):k((function(t){return Object(u.a)(Object(u.a)({},t),{},{slug:e,slugArray:[].concat(Object(g.a)(t.slugArray),[e])})}))}),[C.title,C.slugArray]);var E=function(){var e=Object(w.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:n=e.sent,k(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(e){var t=Object(g.a)(C.categories).filter((function(t){return t!==e}));k((function(e){return Object(u.a)(Object(u.a)({},e),{},{categories:t})}))},I=function(){r.current.selectedIndex=0,x("default")},F=function(){B.a.fire({title:"\xbfSeguro?",text:"No has guardado, si sales sin guardar, se perder\xe1n los cambios",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\xa1Si, salir!",cancelButtonText:"\xa1Uy, no!"}).then((function(e){e.isConfirmed&&n.goBack()}))},A=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(t);case 2:n.goBack();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(w.a)(N.a.mark((function e(t,a){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t,a);case 2:n.goBack();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(w.a)(N.a.mark((function e(t,n){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="text"===e.t0?3:"image"===e.t0?7:11;break;case 3:return e.next=5,ne(n);case 5:return k((function(e){return Object(u.a)(Object(u.a)({},e),{},{content:Object(u.a)(Object(u.a)({},e.content),{},{text:e.content.text.filter((function(e){return e._id!==n}))})})})),e.abrupt("break",12);case 7:return e.next=9,ce(n);case 9:return k((function(e){return Object(u.a)(Object(u.a)({},e),{},{content:Object(u.a)(Object(u.a)({},e.content),{},{image:e.content.image.filter((function(e){return e._id!==n}))})})})),e.abrupt("break",12);case 11:return e.abrupt("break",12);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(S.jsxs)("section",{id:"add-posts-screen",children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695842/web/blog-single_zvpet3.svg",title:"Est\xe1s editando esta entrada:",instructions:C.title}),Object(S.jsxs)("article",{className:"post-btn-group",children:[Object(S.jsx)("button",{className:"my-btn mini",onClick:function(){return P(p,C)},children:"Guardar Entrada"}),Object(S.jsx)("button",{className:"my-btn mini third",onClick:function(){return F()},children:"Salir"}),Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return A(p)},children:"Borrar Entrada"})]}),Object(S.jsxs)("section",{className:"edit-post",children:[Object(S.jsxs)("div",{className:"edit-area",children:[Object(S.jsx)(re,{selectedPost:k,handleInputChange:l,saveTitles:function(e){e.preventDefault(),k(Object(u.a)(Object(u.a)({},C),{},{title:o.title,subtitle:o.subtitle}))}}),Object(S.jsx)(he,{selectedPost:k,handleInputChange:l,saveDate:function(e){e.preventDefault(),k(Object(u.a)(Object(u.a)({},C),{},{postDate:o.postDate}))}}),Object(S.jsx)(pe,{savePostState:function(e){k(Object(u.a)(Object(u.a)({},C),{},{status:e}))},postState:C.status}),Object(S.jsx)(fe,{saveCategory:function(e){C.categories.includes(e)||k((function(t){return Object(u.a)(Object(u.a)({},t),{},{categories:[].concat(Object(g.a)(t.categories),[e])})}))},deleteCategory:T}),Object(S.jsx)(be,{auxContent:f,setAuxContent:x,select:r,postId:p,saveElement:function(e,t){switch(e){case"text":if(C.content.text.length>0){var n=[].concat(Object(g.a)(C.content.text),[t]);k(Object(u.a)(Object(u.a)({},C),{},{content:Object(u.a)(Object(u.a)({},C.content),{},{text:n})})),I()}else{var a=[t];k(Object(u.a)(Object(u.a)({},C),{},{content:Object(u.a)(Object(u.a)({},C.content),{},{text:a})})),I()}break;case"image":if(C.content.image.length>0){var c=[].concat(Object(g.a)(C.content.image),[t]);k(Object(u.a)(Object(u.a)({},C),{},{content:Object(u.a)(Object(u.a)({},C.content),{},{image:c})})),I()}else{var r=[t];k(Object(u.a)(Object(u.a)({},C),{},{content:Object(u.a)(Object(u.a)({},C.content),{},{image:r})})),I()}}}}),C.content.image.length>1&&Object(S.jsx)(me,{setSelectedPost:k})]}),Object(S.jsxs)("div",{className:"view-area",children:[Object(S.jsx)("div",{className:"titles-btn",children:Object(S.jsxs)("div",{children:[C.title&&Object(S.jsx)("h1",{children:C.title}),C.subtitle&&Object(S.jsx)("h2",{children:C.subtitle}),C.postDate?Object(S.jsxs)("p",{children:["Publicada el: ",W()(C.postDate).format("DD/MM/YYYY")]}):Object(S.jsxs)("p",{children:["Publicada el: ",W()(C.createdAt).format("DD/MM/YYYY")]}),(null===C||void 0===C||null===(e=C.categories)||void 0===e?void 0:e.length)>0&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("p",{children:"Categor\xedas de la publicaci\xf3n"}),Object(S.jsx)("div",{className:"features",children:null===C||void 0===C||null===(t=C.categories)||void 0===t?void 0:t.map((function(e){return Object(S.jsxs)("div",{className:"each-feat",children:[e," ",Object(S.jsx)(V.b,{onClick:function(){return T(e)}})," "]},e)}))})]})]})}),Object(S.jsx)("hr",{}),C.content.text.length>0&&C.content.text.map((function(e){return Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{dangerouslySetInnerHTML:e.parsedText}),Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return L("text",e._id)},children:"Borrar este texto"})]},e._id)})),C.content.image.length>0&&C.content.image.map((function(e){return Object(S.jsxs)("div",{children:[Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:e.image,alt:""})}),Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return L("image",e._id)},children:"Borrar esta imagen"})]},e._id)}))]})]})]})},Ee=function(){var e=Object(w.a)(N.a.mark((function e(){var t,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("sections/","GET");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n.sections);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("sections/",t,"POST");case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a.section);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),De=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("sections/".concat(n),t,"PUT");case 2:return e.next=4,O("sections");case 4:return a=e.sent,e.next=7,a.json();case 7:return c=e.sent,e.abrupt("return",c.sections);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("sections/".concat(t),{},"DELETE");case 2:return e.next=4,O("sections");case 4:return n=e.sent,e.next=7,n.json();case 7:return a=e.sent,e.abrupt("return",a.sections);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Be=c.a.memo((function(e){var t=e.nameValue,n=e.deleteField,c=e.inputType,r=e.editLabel,i=e.editAction,o=e.editValue,u=e.submitEdit,l=e.imageEdit,d=void 0!==l&&l,j=Object(a.useState)(!1),b=Object(s.a)(j,2),m=b[0],O=b[1],h=function(){return O(!1)},f=function(){return O(!0)};return Object(S.jsxs)(S.Fragment,{children:[o?Object(S.jsxs)("div",{className:"edit-group",children:[d?Object(S.jsxs)("div",{children:[Object(S.jsxs)("p",{children:[r,": "]}),Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:o,alt:t})})]}):Object(S.jsxs)("p",{children:[r,": ",Object(S.jsx)("strong",{children:o})]}),Object(S.jsxs)("div",{children:[Object(S.jsx)("button",{className:"my-btn mini danger",onClick:function(){return n(t)},children:"Borrar"}),Object(S.jsx)("button",{className:"my-btn mini",onClick:f,children:"Editar"})]})]}):Object(S.jsxs)("div",{className:"edit-group",children:[Object(S.jsxs)("p",{children:[r,": ",Object(S.jsx)("small",{children:"Sin datos"})]}),Object(S.jsx)("button",{className:"my-btn mini",onClick:f,children:"A\xf1adir"})]}),Object(S.jsxs)(p.a,{className:"my-modals",show:m,onHide:h,children:[Object(S.jsx)(p.a.Header,{children:Object(S.jsx)(p.a.Title,{children:o})}),Object(S.jsx)(p.a.Body,{children:Object(S.jsxs)("form",{className:"edit-form",onSubmit:u,children:[Object(S.jsx)("input",{name:t,type:c,onChange:i,placeholder:o}),Object(S.jsx)("button",{className:"my-btn",type:"submit",onClick:h,children:"Guardar"})]})}),Object(S.jsx)(p.a.Footer,{children:Object(S.jsx)("button",{className:"my-btn",onClick:h,children:"cerrar"})})]})]})})),Fe=function e(t){var n=t.setQuill,c=t.handleQuill,r=t.setParsed,i=Object(a.useState)(""),o=Object(s.a)(i,2),u=o[0],l=o[1],d=Object(a.useRef)(null);return Object(a.useEffect)((function(){n(u),r({__html:u})}),[u,n,r]),Object(S.jsxs)("div",{children:[Object(S.jsx)("div",{className:"text-editor",children:Object(S.jsx)(ue.a,{ref:d,modules:{toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:["#dd4124","#f38b2e"]},{background:["#dd4124","#f38b2e"]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link"]]},clipboard:{matchVisual:!1}},formats:e.formats,theme:"snow",value:u,onChange:l})}),Object(S.jsx)("form",{onSubmit:c,children:Object(S.jsx)("button",{type:"submit",className:"my-btn mini secondary",children:"Guardar texto"})})]})};Fe.formats=["header","bold","italic","underline","strike","blockquote","list","bullet","indent","link","align","color","script","background"];var Ae=Fe,Pe=function(){var e=Object(a.useContext)(o).user,t=Object(a.useContext)(v),n=t.dispatchSections,c=t.sections,r=Object(b.useParams)().id,i=D(),d=i.values,j=i.setValues,p=i.handleInputChange,m=i.handleFileChange,O=d.title,h=d.text,f=d.parsedText,x=d.subtitle,y=d._id,k=d.uniqueImage,E=d.gallery,I=d.features,F=d.formInputs,A=Object(b.useHistory)(),P=Object(a.useRef)(),L=Object(a.useState)(),Y=Object(s.a)(L,2),R=Y[0],q=Y[1],G=Object(a.useState)(),U=Object(s.a)(G,2),M=U[0],H=U[1],Q=Object(a.useState)(),J=Object(s.a)(Q,2),z=J[0],$=J[1];Object(a.useEffect)((function(){c.length>0&&(P.current=c.find((function(e){return e._id===r})),j(P.current))}),[r,c,j]);var K=function(e){document.getElementById(e).value=""},W=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,a=n.files[0],e.next=4,T(a);case 4:c=e.sent,q(c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A.push("/bratic"),e.next=3,Ie(r);case 3:t=e.sent,n({type:l.deleteSection,payload:t});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(w.a)(N.a.mark((function e(t){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(Object(u.a)(Object(u.a)({},d),{},Object(C.a)({},t,"")));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(e){e.preventDefault()},te=function(){var e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(d,y);case 2:(t=e.sent)?(B.a.fire("\xa1Chachi!","Los cambios han sido guardados","success"),n({type:l.sectionUpdate,payload:t}),A.push("/bratic")):B.a.fire("\xa1Oh-oh!","Ha habido un error, int\xe9ntalo de nuevo","error");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("section",{className:"section-screen",children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621687077/web/blog-login-image_n0ocyy.svg",title:"Est\xe1s editando esta secci\xf3n",instructions:null===d||void 0===d?void 0:d.sectionName}),Object(S.jsx)("button",{className:"my-btn mini",onClick:te,children:"Guardar Cambios"}),"admin@yai.com"===e.email&&Object(S.jsx)("button",{className:"my-btn mini danger",onClick:X,children:"Borrar esta secci\xf3n"}),(O||""===O)&&Object(S.jsx)(Be,{nameValue:"title",deleteField:Z,inputType:"text",editLabel:"T\xedtulo",editAction:p,editValue:null===d||void 0===d?void 0:d.title,submitEdit:ee}),x&&Object(S.jsx)(Be,{nameValue:"subtitle",deleteField:Z,inputType:"text",editLabel:"Subt\xedtulo",editAction:p,editValue:null===d||void 0===d?void 0:d.subtitle,submitEdit:ee}),k&&Object(S.jsx)(Be,{imageEdit:!0,nameValue:"uniqueImage",deleteField:Z,inputType:"file",editLabel:"Imagen principal",editAction:m,editValue:null===d||void 0===d?void 0:d.uniqueImage,submitEdit:ee}),(null===E||void 0===E?void 0:E.length)>0&&Object(S.jsxs)("div",{className:"edit-gallery",children:[Object(S.jsx)("div",{className:"gallery",children:null===E||void 0===E?void 0:E.map((function(e,t){return Object(S.jsxs)("figure",{className:"each-picture",children:[Object(S.jsx)("img",{src:e,alt:""}),Object(S.jsx)(V.b,{className:"close-icon",onClick:function(){return function(e){var t=Object(g.a)(E);t.splice(e,1),j(Object(u.a)(Object(u.a)({},d),{},{gallery:t}))}(t)}})]},t)}))}),Object(S.jsxs)("div",{className:"button-file-group",children:[Object(S.jsx)("input",{className:"file-input",type:"file",onChange:W,placeholder:"A\xf1adir Foto",name:"gallery"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),E?(null===E||void 0===E?void 0:E.includes(R))||j(Object(u.a)(Object(u.a)({},d),{},{gallery:[].concat(Object(g.a)(E),[R])})):j(Object(u.a)(Object(u.a)({},d),{},{gallery:[R]}))},className:"my-btn mini",children:"A\xf1adir"})]})]}),(null===I||void 0===I?void 0:I.length)>0&&Object(S.jsxs)("div",{className:"edit-features",children:[Object(S.jsx)("div",{className:"features",children:null===I||void 0===I?void 0:I.map((function(e,t){return Object(S.jsxs)("div",{className:"each-feat",children:[e,Object(S.jsx)(V.b,{onClick:function(){return function(e){var t=Object(g.a)(I);t.splice(e,1),j(Object(u.a)(Object(u.a)({},d),{},{features:t}))}(t)}})]},e)}))}),Object(S.jsxs)("div",{className:"button-input-group",children:[Object(S.jsx)("input",{type:"text",id:"to-reset-features",onChange:function(e){q(e.target.value)},placeholder:"A\xf1adir Caracter\xedstica",name:"features"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),I?(null===I||void 0===I?void 0:I.includes(R))||(j(Object(u.a)(Object(u.a)({},d),{},{features:[].concat(Object(g.a)(I),[R])})),K("to-reset-features")):(j(Object(u.a)(Object(u.a)({},d),{},{features:[R]})),K("to-reset-features")),K("to-reset-features")},className:"my-btn mini",children:"A\xf1adir"})]})]}),(null===F||void 0===F?void 0:F.length)>0&&Object(S.jsxs)("div",{className:"edit-features",children:[Object(S.jsx)("div",{className:"features",children:null===F||void 0===F?void 0:F.map((function(e,t){return Object(S.jsxs)("div",{className:"each-feat",children:[e,Object(S.jsx)(V.b,{onClick:function(){return function(e){var t=Object(g.a)(F);t.splice(e,1),j(Object(u.a)(Object(u.a)({},d),{},{formInputs:t}))}(t)}})]},e)}))}),Object(S.jsxs)("div",{className:"button-input-group",children:[Object(S.jsx)("input",{type:"text",id:"to-reset-inputs",onChange:function(e){q(e.target.value)},placeholder:"A\xf1adir Input",name:"formInputs"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),F?(null===F||void 0===F?void 0:F.includes(R))||(j(Object(u.a)(Object(u.a)({},d),{},{formInputs:[].concat(Object(g.a)(F),[R])})),K("to-reset-inputs")):(j(Object(u.a)(Object(u.a)({},d),{},{formInputs:[R]})),K("to-reset-inputs")),K("to-reset-inputs")},className:"my-btn mini",children:"A\xf1adir"})]})]}),h&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("section",{className:"edit-group text-editor-group",children:[Object(S.jsx)("p",{children:"Texto:"}),Object(S.jsx)("div",{dangerouslySetInnerHTML:f})]}),Object(S.jsx)(Ae,{setQuill:H,handleQuill:function(e){e.preventDefault(),j(Object(u.a)(Object(u.a)({},d),{},{text:M,parsedText:z}))},setParsed:$})]})]})})},Le=function(e){var t=e.handleClose,n=Object(a.useContext)(v).dispatchSections,c=Object(a.useState)(),r=Object(s.a)(c,2),i=r[0],o=r[1],d=Object(a.useState)(),j=Object(s.a)(d,2),b=j[0],p=j[1],m=Object(a.useState)(),O=Object(s.a)(m,2),h=O[0],f=O[1],x=D(),y=x.values,C=x.setValues,k=x.handleInputChange,E=x.handleFileChange,I=y.uniqueImage,F=y.gallery,A=y.features,P=y.formInputs,L=function(e){document.getElementById(e).value=""},_=function(){var e=Object(w.a)(N.a.mark((function e(t){var n,a,c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,a=n.files[0],e.next=4,T(a);case 4:c=e.sent,o(c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(w.a)(N.a.mark((function e(a){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,Te(y);case 3:(c=e.sent)?(B.a.fire("\xa1Chachi!","Los cambios han sido guardados","success"),n({type:l.addSection,payload:c})):B.a.fire("\xa1Oh-oh!","Ha habido un error, int\xe9ntalo de nuevo","error"),t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)("section",{className:"section-form",children:[Object(S.jsxs)("div",{className:"left-side",children:[Object(S.jsxs)("label",{children:["Tipo de secci\xf3n* ",(null===y||void 0===y?void 0:y.sectionType)&&Object(S.jsx)(V.a,{})]}),Object(S.jsxs)("select",{onChange:k,name:"sectionType",required:!0,children:[Object(S.jsx)("option",{value:"section",defaultValue:!0,children:"Secci\xf3n"}),Object(S.jsx)("option",{value:"nav",children:"Navegador"}),Object(S.jsx)("option",{value:"header",children:"Cabecera"}),Object(S.jsx)("option",{value:"footer",children:"Footer"})]}),Object(S.jsxs)("label",{children:["Nombre de la secci\xf3n* ",(null===y||void 0===y?void 0:y.sectionName)&&Object(S.jsx)(V.a,{})]}),Object(S.jsx)("input",{type:"text",onChange:k,name:"sectionName",autoComplete:"off",placeholder:"Nombre de la secci\xf3n",required:!0}),Object(S.jsxs)("label",{children:["T\xedtulo ",(null===y||void 0===y?void 0:y.title)&&Object(S.jsx)(V.a,{})]}),Object(S.jsx)("input",{type:"text",onChange:k,autoComplete:"off",name:"title",placeholder:"T\xedtulo",required:!0}),Object(S.jsx)("label",{children:"Subt\xedtulo "}),Object(S.jsx)("input",{type:"text",onChange:k,autoComplete:"off",name:"subtitle",placeholder:"Subt\xedtulo"}),Object(S.jsx)("label",{children:"Imagen principal"}),I&&Object(S.jsx)("figure",{className:"unique-image",children:Object(S.jsx)("img",{src:I,alt:""})}),Object(S.jsx)("input",{className:"file-input",type:"file",onChange:E,name:"uniqueImage"}),Object(S.jsx)("label",{htmlFor:"",children:"Galer\xeda de im\xe1genes"}),Object(S.jsx)("div",{className:"gallery",children:null===F||void 0===F?void 0:F.map((function(e,t){return Object(S.jsxs)("figure",{className:"each-picture",children:[Object(S.jsx)("img",{src:e,alt:""}),Object(S.jsx)(V.b,{className:"close-icon",onClick:function(){return function(e){var t=Object(g.a)(F);t.splice(e,1),C(Object(u.a)(Object(u.a)({},y),{},{gallery:t}))}(t)}})]},t)}))}),Object(S.jsxs)("div",{className:"button-file-group",children:[Object(S.jsx)("input",{className:"file-input",type:"file",onChange:_,placeholder:"A\xf1adir Foto",name:"gallery"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),F?(null===F||void 0===F?void 0:F.includes(i))||C(Object(u.a)(Object(u.a)({},y),{},{gallery:[].concat(Object(g.a)(F),[i])})):C(Object(u.a)(Object(u.a)({},y),{},{gallery:[i]}))},className:"my-btn mini third",children:"A\xf1adir"})]})]}),Object(S.jsxs)("div",{className:"right-side",children:[Object(S.jsx)("label",{children:"Texto "}),Object(S.jsx)(Ae,{setQuill:p,handleQuill:function(e){e.preventDefault(),C(Object(u.a)(Object(u.a)({},y),{},{text:b,parsedText:h}))},setParsed:f}),Object(S.jsx)("label",{htmlFor:"",children:"Caracter\xedsticas"}),Object(S.jsx)("div",{className:"features",children:null===A||void 0===A?void 0:A.map((function(e,t){return Object(S.jsxs)("div",{className:"each-feat",children:[e,Object(S.jsx)(V.b,{onClick:function(){return function(e){var t=Object(g.a)(A);t.splice(e,1),C(Object(u.a)(Object(u.a)({},y),{},{features:t}))}(t)}})]},e)}))}),Object(S.jsxs)("div",{className:"button-input-group",children:[Object(S.jsx)("input",{type:"text",id:"to-reset-section-features",onChange:function(e){o(e.target.value)},placeholder:"A\xf1adir Caracter\xedstica",name:"features"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),A?(null===A||void 0===A?void 0:A.includes(i))||(C(Object(u.a)(Object(u.a)({},y),{},{features:[].concat(Object(g.a)(A),[i])})),L("to-reset-section-features")):(C(Object(u.a)(Object(u.a)({},y),{},{features:[i]})),L("to-reset-section-features")),L("to-reset-section-features")},className:"my-btn mini third",children:"A\xf1adir"})]}),Object(S.jsx)("label",{children:"Inputs del formulario"}),Object(S.jsx)("div",{className:"features",children:null===P||void 0===P?void 0:P.map((function(e,t){return Object(S.jsxs)("div",{className:"each-feat",children:[e,Object(S.jsx)(V.b,{onClick:function(){return function(e){var t=Object(g.a)(P);t.splice(e,1),C(Object(u.a)(Object(u.a)({},y),{},{formInputs:t}))}(t)}})]},e)}))}),Object(S.jsxs)("div",{className:"button-input-group",children:[Object(S.jsx)("input",{type:"text",id:"to-reset-section-inputs",onChange:function(e){o(e.target.value)},placeholder:"A\xf1adir Input",name:"formInputs"}),Object(S.jsx)("button",{onClick:function(e){e.preventDefault(),P?(null===P||void 0===P?void 0:P.includes(i))||(C(Object(u.a)(Object(u.a)({},y),{},{formInputs:[].concat(Object(g.a)(P),[i])})),L("to-reset-section-inputs")):(C(Object(u.a)(Object(u.a)({},y),{},{formInputs:[i]})),L("to-reset-section-inputs")),L("to-reset-section-inputs")},className:"my-btn mini third",children:"A\xf1adir"})]})]})]}),Object(S.jsx)("form",{className:"section-form",onSubmit:Y,children:Object(S.jsx)("button",{className:"my-btn mini",type:"submit",children:"Guardar Datos"})})]})},_e=function(){var e=Object(w.a)(N.a.mark((function e(t,n){var a,c,r,i;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("auth/login",{email:t,password:n},"POST");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=13;break}return r={id:c.id,name:c.name,email:c.email,logged:!0,token:c.token},localStorage.setItem("bratic-user",JSON.stringify(r)),localStorage.setItem("bratic-token",c.token),e.abrupt("return",r);case 13:i=c.msg,B.a.fire("Error",i,"error");case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(w.a)(N.a.mark((function e(t,n,a){var c,r,i,s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("auth/signup",{name:t,email:n,password:a},"POST");case 2:return c=e.sent,e.next=5,c.json();case 5:if(!(r=e.sent).ok){e.next=13;break}return i={id:r.id,name:r.name,email:r.email,token:r.token,logged:!0},localStorage.setItem("bratic-user",JSON.stringify(i)),localStorage.setItem("bratic-token",r.token),e.abrupt("return",i);case 13:s=r.msg,B.a.fire("Error",s,"error");case 15:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),Ye=function(){var e=D({}),t=e.values,n=e.handleInputChange,c=t.email,r=t.password,i=Object(a.useContext)(o).dispatch,s=function(){var e=Object(w.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,_e(c,r);case 3:n=e.sent,i({type:l.login,payload:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("section",{className:"login",children:[Object(S.jsxs)("form",{onSubmit:s,children:[Object(S.jsx)("label",{children:"Email"}),Object(S.jsx)("input",{type:"email",onChange:n,placeholder:"Tu email",name:"email"}),Object(S.jsx)("label",{children:"Contrase\xf1a"}),Object(S.jsx)("input",{type:"password",onChange:n,placeholder:"Contrase\xf1a",name:"password"}),Object(S.jsx)("button",{type:"submit",className:"my-btn mini",children:"Entrar"})]}),Object(S.jsxs)("small",{children:["\xbfNo tienes cuenta? Crea una ",Object(S.jsx)(j.b,{to:"/registro",children:"aqu\xed"})," "]})]})})},Re=function(){var e=D({}),t=e.values,n=e.handleInputChange,c=t.name,r=t.email,i=t.password,s=t.password2,u=Object(a.useContext)(o).dispatch,d=function(){var e=Object(w.a)(N.a.mark((function e(t){var n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i!==s){e.next=8;break}return e.next=4,Ve(c,r,i);case 4:n=e.sent,u({type:l.signup,payload:n}),e.next=9;break;case 8:B.a.fire("Error","Las contrase\xf1as deben coincidir","error");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsx)(S.Fragment,{children:Object(S.jsxs)("section",{className:"login",children:[Object(S.jsxs)("form",{onSubmit:d,children:[Object(S.jsx)("label",{children:"Nombre"}),Object(S.jsx)("input",{type:"text",onChange:n,placeholder:"Tu nombre",name:"name"}),Object(S.jsx)("label",{children:"Email"}),Object(S.jsx)("input",{type:"email",onChange:n,placeholder:"Tu email",name:"email"}),Object(S.jsx)("label",{children:"Contrase\xf1a"}),Object(S.jsx)("input",{type:"password",onChange:n,placeholder:"Contrase\xf1a",name:"password"}),Object(S.jsx)("label",{children:"Repite Contrase\xf1a"}),Object(S.jsx)("input",{type:"password",onChange:n,placeholder:"Repite Contrase\xf1a",name:"password2"}),Object(S.jsx)("button",{type:"submit",className:"my-btn mini",children:"Registro"})]}),Object(S.jsxs)("small",{children:["\xbfYa est\xe1s registrado? Entra ",Object(S.jsx)(j.b,{to:"/",children:"aqu\xed"})," "]})]})})},qe=function(){return Object(S.jsxs)("nav",{className:"login-nav",children:[Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:"https://res.cloudinary.com/bratic-app/image/upload/v1609866461/logoBN_ujpbti.svg",alt:""})}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:Object(S.jsx)(j.b,{to:"/",children:"Entrar"})}),Object(S.jsx)("li",{children:Object(S.jsx)(j.b,{to:"/registro",children:"Registro"})})]})]})},Ge=function(e){var t=e.section;return Object(S.jsx)(j.b,{className:"each-section",to:"/bratic/seccion/".concat(t._id),children:t.sectionName})},Ue=function(){var e=Object(a.useState)(),t=Object(s.a)(e,2),n=t[0],c=t[1],r=function(){var e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){r()}),[]),Object(S.jsxs)("section",{className:"all-sections",children:[Object(S.jsx)(_,{image:"https://res.cloudinary.com/bratic-app/image/upload/v1621695842/web/sections_r2ejno.svg",title:"Secciones de tu web",instructions:"Aqu\xed ver\xe1s todas las secciones que componen tu web. Pincha en cualquiera para editarla :). Si necesitas a\xf1adir una nueva secci\xf3n, ponte en contacto con el webmaster."}),(null===n||void 0===n?void 0:n.length)>0&&n.map((function(e){return Object(S.jsx)(Ge,{section:e},e._id)}))]})},Me=function(){var e=Object(a.useRef)(!0),t=Object(a.useContext)(o).user,n=Object(a.useReducer)(x,{}),c=Object(s.a)(n,2),r=c[0],i=c[1],d=Object(a.useReducer)(y,{}),m=Object(s.a)(d,2),h=m[0],g=m[1];Object(a.useEffect)((function(){return function(){e.current=!1}})),Object(a.useEffect)((function(){e.current&&(O("sections").then((function(e){return e.json()})).then((function(e){return g({type:l.getSections,payload:e.sections})})).catch((function(e){return new Error(e)})),O("companies").then((function(e){return e.json()})).then((function(e){return i({type:l.getCompany,payload:e.company[0]})})).catch((function(e){return new Error(e)})))}),[]);var C=Object(a.useState)(!1),k=Object(s.a)(C,2),N=k[0],w=k[1],E=function(){return w(!1)};return Object(S.jsx)(j.a,{children:Object(S.jsx)("div",{children:t.token?Object(S.jsx)(f.Provider,{value:{company:r,dispatchCompany:i},children:Object(S.jsx)(v.Provider,{value:{sections:h,dispatchSections:g},children:Object(S.jsxs)("div",{className:"dashboard-container",children:[Object(S.jsx)(M,{handleShow:function(){return w(!0)}}),Object(S.jsxs)("main",{children:[Object(S.jsxs)(b.Switch,{children:[Object(S.jsx)(b.Route,{exact:!0,path:"/bratic",component:G}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/empresa",component:q}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/blog",component:Z}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/blog/nueva-entrada/:postID",component:xe}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/blog/:postID",component:we}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/blog/editar-entrada/:postID",component:Se}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/seccion",component:Ue}),Object(S.jsx)(b.Route,{exact:!0,path:"/bratic/seccion/:id",component:function(e){return Object(S.jsx)(Pe,Object(u.a)({},e))}}),Object(S.jsx)(b.Redirect,{to:"/bratic"})]}),Object(S.jsxs)(p.a,{dialogClassName:"modal-width",centered:!0,className:"my-modals",show:N,onHide:E,children:[Object(S.jsx)(p.a.Header,{children:Object(S.jsx)("h4",{children:"A\xf1adir Secci\xf3n a la web"})}),Object(S.jsx)(p.a.Body,{children:Object(S.jsx)(Le,{handleClose:E})}),Object(S.jsx)(p.a.Footer,{children:Object(S.jsx)("button",{className:"my-btn mini secondary",onClick:E,children:"cerrar"})})]})]})]})})}):Object(S.jsxs)("section",{children:[Object(S.jsx)(qe,{}),Object(S.jsxs)("main",{className:"login-container",children:[Object(S.jsx)("figure",{children:Object(S.jsx)("img",{src:"https://res.cloudinary.com/bratic-app/image/upload/v1621687697/web/blog-login_lgl2ch.svg",alt:""})}),Object(S.jsxs)(b.Switch,{children:[Object(S.jsx)(b.Route,{exact:!0,path:"/",component:Ye}),Object(S.jsx)(b.Route,{path:"/registro",component:Re}),Object(S.jsx)(b.Redirect,{to:"/"})]}),Object(S.jsxs)("div",{className:"copyright",children:[Object(S.jsx)("small",{children:"Made with \u2665 by Yai"}),Object(S.jsx)("small",{children:"\xa9 Bratic S.L."})]})]})]})})})},He=function(){return JSON.parse(localStorage.getItem("bratic-user"))||{logged:!1}},Qe=function(){var e=Object(a.useRef)(!0),t=Object(a.useReducer)(d,{},He),n=Object(s.a)(t,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){return function(){e.current=!1}}),[]),Object(a.useEffect)((function(){e.current&&localStorage.setItem("bratic-user",JSON.stringify(c))}),[c]),Object(S.jsx)(S.Fragment,{children:Object(S.jsx)(o.Provider,{value:{user:c,dispatch:r},children:Object(S.jsx)(Me,{})})})};i.a.render(Object(S.jsx)(Qe,{}),document.getElementById("root"))},99:function(e,t,n){}},[[217,1,2]]]);
//# sourceMappingURL=main.48391a34.chunk.js.map