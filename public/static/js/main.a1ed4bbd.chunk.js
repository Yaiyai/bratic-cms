(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{33:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),c=n(23),s=n.n(c),i=n(17),o=(0,n(1).createContext)(),l=n(10),u="[auth] login",j="[auth] signup",b="[auth] logout",d="[auth] hastoken",p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:case j:case d:return Object(l.a)({},t.payload);case b:return{logged:!1};default:return e}},h=(n(32),n(33),n(24)),m=n(26),O=n(15),x=n(8),f=n(2),g=n(3),v=n.n(g),y=n(5),w="https://bratic-app.herokuapp.com/api",k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",r="".concat(w,"/").concat(e);return"GET"===n?fetch(r):fetch(r,{method:n,headers:{"Content-type":"application/json"},body:JSON.stringify(t)})},C=n(14),S=n.n(C),N=function(){var e=Object(y.a)(v.a.mark((function e(t,n){var r,a,c,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k("auth/login",{email:t,password:n},"POST");case 2:return r=e.sent,e.next=5,r.json();case 5:if(!(a=e.sent).ok){e.next=13;break}return c={id:a.id,name:a.name,email:a.email,logged:!0,token:a.token},localStorage.setItem("bratic-user",JSON.stringify(c)),localStorage.setItem("bratic-token",a.token),e.abrupt("return",c);case 13:s=a.msg,S.a.fire("Error",s,"error");case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(y.a)(v.a.mark((function e(t,n,r){var a,c,s,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k("auth/signup",{name:t,email:n,password:r},"POST");case 2:return a=e.sent,e.next=5,a.json();case 5:if(!(c=e.sent).ok){e.next=13;break}return s={id:c.id,name:c.name,email:c.email,token:c.token,logged:!0},localStorage.setItem("bratic-user",JSON.stringify(s)),localStorage.setItem("bratic-token",c.token),e.abrupt("return",s);case 13:i=c.msg,S.a.fire("Error",i,"error");case 15:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),I=n(13),F=function(){var e=Object(y.a)(v.a.mark((function e(t){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api.cloudinary.com/v1_1/bratic-app/upload",(n=new FormData).append("upload_preset","bratic-app"),n.append("file",t),e.next=6,fetch("https://api.cloudinary.com/v1_1/bratic-app/upload",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){return r=e.secure_url})).catch((function(e){return console.log(e)}));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(a.useState)(e),n=Object(i.a)(t,2),r=n[0],c=n[1],s=function(){c(e)},o=function(e){var t=e.target;c(Object(l.a)(Object(l.a)({},r),{},Object(I.a)({},t.name,t.value)))},u=function(){var e=Object(y.a)(v.a.mark((function e(t){var n,a,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,a=n.files[0],e.next=4,F(a);case 4:return s=e.sent,e.next=7,c(Object(l.a)(Object(l.a)({},r),{},Object(I.a)({},n.name,s)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{values:r,setValues:c,handleInputChange:o,handleFileChange:u,resetForm:s}},J=function(){var e=T({}),t=e.values,n=e.handleInputChange,c=t.email,s=t.password,i=Object(a.useContext)(o).dispatch,l=function(){var e=Object(y.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,N(c,s);case 3:n=e.sent,i({type:u,payload:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("section",{className:"login",children:[Object(r.jsxs)("form",{onSubmit:l,children:[Object(r.jsx)("label",{children:"Email"}),Object(r.jsx)("input",{type:"email",onChange:n,placeholder:"Tu email",name:"email"}),Object(r.jsx)("label",{children:"Contrase\xf1a"}),Object(r.jsx)("input",{type:"password",onChange:n,placeholder:"Contrase\xf1a",name:"password"}),Object(r.jsx)("button",{type:"submit",className:"my-btn mini",children:"Entrar"})]}),Object(r.jsxs)("small",{children:["\xbfNo tienes cuenta? Crea una ",Object(r.jsx)(x.b,{to:"/registro",children:"aqu\xed"})," "]})]})})},B=function(){var e=T({}),t=e.values,n=e.handleInputChange,c=t.name,s=t.email,i=t.password,l=t.password2,u=Object(a.useContext)(o).dispatch,b=function(){var e=Object(y.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),i!==l){e.next=8;break}return e.next=4,E(c,s,i);case 4:n=e.sent,u({type:j,payload:n}),e.next=9;break;case 8:S.a.fire("Error","Las contrase\xf1as deben coincidir","error");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("section",{className:"login",children:[Object(r.jsxs)("form",{onSubmit:b,children:[Object(r.jsx)("label",{children:"Nombre"}),Object(r.jsx)("input",{type:"text",onChange:n,placeholder:"Tu nombre",name:"name"}),Object(r.jsx)("label",{children:"Email"}),Object(r.jsx)("input",{type:"email",onChange:n,placeholder:"Tu email",name:"email"}),Object(r.jsx)("label",{children:"Contrase\xf1a"}),Object(r.jsx)("input",{type:"password",onChange:n,placeholder:"Contrase\xf1a",name:"password"}),Object(r.jsx)("label",{children:"Repite Contrase\xf1a"}),Object(r.jsx)("input",{type:"password",onChange:n,placeholder:"Repite Contrase\xf1a",name:"password2"}),Object(r.jsx)("button",{type:"submit",className:"my-btn mini",children:"Registro"})]}),Object(r.jsxs)("small",{children:["\xbfYa est\xe1s registrado? Entra ",Object(r.jsx)(x.b,{to:"/",children:"aqu\xed"})," "]})]})})},R=function(){var e=Object(a.useContext)(o).user;return Object(r.jsx)("div",{children:Object(r.jsxs)("h1",{children:["\xa1Bienvenid@ ",e.name,"!"]})})},_=function(){var e=Object(a.useContext)(o).dispatch,t=function(){var t=Object(y.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e({type:b});case 2:localStorage.removeItem("bratic-token"),localStorage.removeItem("bratic-user");case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)("nav",{className:"dash-nav",children:[Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(x.b,{to:"/bratic",children:Object(r.jsx)("figure",{children:Object(r.jsx)("img",{src:"https://res.cloudinary.com/bratic-app/image/upload/v1609866461/logoBN_ujpbti.svg",alt:""})})})}),Object(r.jsx)("li",{children:Object(r.jsx)(x.b,{to:"/bratic/empresa",children:"Datos de empresa"})})]}),Object(r.jsxs)("div",{className:"btn-group",children:[Object(r.jsx)("small",{children:"Made with \u2665 by Yai"}),Object(r.jsx)("small",{children:"\xa9 Bratic S.L."}),Object(r.jsx)("button",{className:"my-btn secondary mini",onClick:t,children:"Cerrar Sesi\xf3n"})]})]})})},D=function(){return Object(r.jsx)("nav",{className:"login-nav",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("figure",{children:Object(r.jsx)("img",{src:"https://res.cloudinary.com/bratic-app/image/upload/v1609866461/logoBN_ujpbti.svg",alt:""})}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(x.b,{to:"/",children:"Entrar"})}),Object(r.jsx)("li",{children:Object(r.jsx)(x.b,{to:"/registro",children:"Registro"})})]})]})})},P=function(){var e=Object(a.useContext)(o).user;return Object(r.jsx)(x.a,{children:Object(r.jsx)("div",{children:e.token?Object(r.jsxs)("div",{className:"dashboard-container",children:[Object(r.jsx)(_,{}),Object(r.jsx)("main",{children:Object(r.jsxs)(f.d,{children:[Object(r.jsx)(f.b,{exact:!0,path:"/bratic",component:R}),Object(r.jsx)(f.a,{to:"/bratic"})]})})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(D,{}),Object(r.jsxs)("main",{className:"container",children:[Object(r.jsxs)(f.d,{children:[Object(r.jsx)(f.b,{exact:!0,path:"/",component:J}),Object(r.jsx)(f.b,{path:"/registro",component:B}),Object(r.jsx)(f.a,{to:"/"})]}),Object(r.jsx)("small",{children:"Made with \u2665 by Yai"}),Object(r.jsx)("small",{children:"\xa9 Bratic S.L."})]})]})})})};h.a.add(m.a,O.d,O.b,O.c,O.a);var L=function(){return JSON.parse(localStorage.getItem("bratic-user"))||{logged:!1}},Y=function(){var e=Object(a.useRef)(!0),t=Object(a.useReducer)(p,{},L),n=Object(i.a)(t,2),c=n[0],s=n[1];return Object(a.useEffect)((function(){return function(){e.current=!1}}),[]),Object(a.useEffect)((function(){e.current&&localStorage.setItem("bratic-user",JSON.stringify(c))}),[c]),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(o.Provider,{value:{user:c,dispatch:s},children:Object(r.jsx)(P,{})})})};s.a.render(Object(r.jsx)(Y,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.a1ed4bbd.chunk.js.map